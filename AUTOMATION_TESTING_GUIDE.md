# ๐งช ุฏููู ุงุฎุชุจุงุฑ ูุญุฑู ุงูุฃุชูุชุฉ ุงููุญุฏุซ

## โ ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ

### 1. **ุฅุตูุงุญ ุฎุทุฃ replaceMessageVariables**
- โ ุชู ุฅุตูุงุญ ุฎุทุฃ `Cannot read properties of undefined (reading 'replace')`
- โ ุชู ุฅุถุงูุฉ ูุนุงูุฌุฉ ุดุงููุฉ ููุจูุงูุงุช ุงูููููุฏุฉ
- โ ุชู ุฅุตูุงุญ ุงุณุชุฎุฑุงุฌ templates ูู ConfigService

### 2. **ุชุญุณููุงุช ุงูุฃูุงู ูุงูุงุณุชูุฑุงุฑ**
- โ ุฅุถุงูุฉ validation ููู templates ูุจู ุงูุงุณุชุฎุฏุงู
- โ ูุนุงูุฌุฉ ุฃุฎุทุงุก ุดุงููุฉ ูุน fallback messages
- โ ุชุณุฌูู ููุตู ููุฃุฎุทุงุก ูุณูููุฉ ุงูุชุดุฎูุต

### 3. **ุฅุถุงูุฉ ุทุฑู ุงุฎุชุจุงุฑ ุขููุฉ**
- โ ุฅุถุงูุฉ `testMessageReplacement` method ููุงุฎุชุจุงุฑ
- โ ุฅุถุงูุฉ endpoint ุงุฎุชุจุงุฑ `/api/test/automation-engine`

## ๐ง ุงุฎุชุจุงุฑ ุงููุธุงู

### 1. **ุงุฎุชุจุงุฑ ูุญุฑู ุงูุฃุชูุชุฉ**
```bash
# ุงุฎุชุจุงุฑ ุดุงูู ูููุญุฑู
GET /api/test/automation-engine

# ุงููุชูุฌุฉ ุงููุชููุนุฉ:
{
  "success": true,
  "tests": {
    "templatesStructure": {
      "hasTemplatesProperty": true,
      "templateKeys": ["newOrder", "noAnswer", "shipped", "rejectedOffer", "reminder"],
      "newOrderTemplate": "Available"
    },
    "messageReplacement": {
      "success": true,
      "messageLength": 150,
      "preview": "ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงููู ูุน ุญุถุฑุชู ูุจู..."
    }
  }
}
```

### 2. **ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุงููุณุชูุฑ**
```bash
# ุชููุฆุฉ ุงูุงุชุตุงู
POST /api/whatsapp/init-persistent

# ูุญุต ุงูุญุงูุฉ
GET /api/whatsapp/persistent-connection

# ุงููุชูุฌุฉ ุงููุชููุนุฉ:
{
  "success": true,
  "connection": {
    "isConnected": true,
    "quality": "excellent"
  }
}
```

### 3. **ุงุฎุชุจุงุฑ ุฅุฑุณุงู ุงูุฑุณุงุฆู**
```bash
# ุชุดุบูู ูุญุฑู ุงูุฃุชูุชุฉ
POST /api/automation/start

# ูุญุต ุงูุญุงูุฉ
GET /api/automation/status

# ุงููุชูุฌุฉ ุงููุชููุนุฉ:
{
  "engine": {
    "isRunning": true
  },
  "whatsapp": {
    "isConnected": true
  }
}
```

## ๐ ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ ุงูุชูุตูููุฉ

### ุงูุฎุทูุฉ 1: ุชููุฆุฉ ุงููุธุงู
1. **ุชุฃูุฏ ูู ุชุดุบูู ุงูุชุทุจูู**: `npm run dev`
2. **ุงุฎุชุจุฑ ูุญุฑู ุงูุฃุชูุชุฉ**: `GET /api/test/automation-engine`
3. **ุชุญูู ูู ุงููุชุงุฆุฌ**: ูุฌุจ ุฃู ุชููู ุฌููุน ุงูุงุฎุชุจุงุฑุงุช ูุงุฌุญุฉ

### ุงูุฎุทูุฉ 2: ุงุฎุชุจุงุฑ ุงููุงุชุณุงุจ
1. **ุชููุฆุฉ ุงูุงุชุตุงู**: `POST /api/whatsapp/init-persistent`
2. **ูุณุญ QR Code**: ุฅุฐุง ูู ููู ูุชุตูุงู
3. **ุชุญูู ูู ุงูุงุชุตุงู**: `GET /api/whatsapp/persistent-connection`

### ุงูุฎุทูุฉ 3: ุงุฎุชุจุงุฑ ุงูุฃุชูุชุฉ
1. **ุชุดุบูู ุงููุญุฑู**: `POST /api/automation/start`
2. **ุชุบููุฑ ุญุงูุฉ ุทูุจ**: ูู Google Sheets ุฅูู "ุฌุฏูุฏ"
3. **ูุฑุงูุจุฉ ุงูู logs**: ูุฌุจ ุฃู ุชุฑู ุฑุณุงุฆู ุงููุนุงูุฌุฉ
4. **ุชุญูู ูู ุงูุฅุฑุณุงู**: ูุฌุจ ุฅุฑุณุงู ุฑุณุงูุฉ ููุนููู

### ุงูุฎุทูุฉ 4: ุงุฎุชุจุงุฑ ุงูุญุงูุงุช ุงููุฎุชููุฉ
```bash
# ุงุฎุชุจุงุฑ ุญุงูุงุช ุงูุทูุจุงุช ุงููุตุฑูุฉ
- "ุฌุฏูุฏ" โ ุฑุณุงูุฉ ุชุฑุญูุจ
- "ูู ูุฑุฏ" โ ุฑุณุงูุฉ ูุชุงุจุนุฉ  
- "ุชู ุงูุดุญู" โ ุฑุณุงูุฉ ุชุฃููุฏ
- "ูุฑููุถ" โ ุนุฑุถ ุฎุงุต ุจุนุฏ 24 ุณุงุนุฉ
```

## ๐ ูุฑุงูุจุฉ ุงูุฃุฏุงุก

### 1. **ูุฑุงูุจุฉ ุงูู Logs**
```bash
# ูู terminal ุงูุชุทุจูู ุงุจุญุซ ุนู:
โ Template replacement successful
๐ Processing order [ID]: NEW - ุฌุฏูุฏ
โ Message sent successfully to [phone]
```

### 2. **ูุฑุงูุจุฉ ุงูุฃุฎุทุงุก**
```bash
# ุฅุฐุง ุฑุฃูุช ูุฐู ุงูุฃุฎุทุงุก:
โ Invalid template provided to replaceMessageVariables
โ Invalid row data provided to replaceMessageVariables
โ Error in replaceMessageVariables

# ุชุญูู ูู:
- ุชูููู ุงูู templates ูู /api/config/messages
- ุตุญุฉ ุจูุงูุงุช Google Sheets
- ุงุชุตุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช
```

### 3. **ุฅุญุตุงุฆูุงุช ุงูุฃุฏุงุก**
```bash
GET /api/automation/status

# ุฑุงูุจ:
- processing.totalOrders: ุนุฏุฏ ุงูุทูุจุงุช ุงููุนุงูุฌุฉ
- whatsapp.isConnected: ุญุงูุฉ ุงูุงุชุตุงู
- summary.queuedMessages: ุงูุฑุณุงุฆู ูู ุงูุงูุชุธุงุฑ
```

## โ๏ธ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดููุฉ: ูุง ูุชู ุฅุฑุณุงู ุฑุณุงุฆู
```bash
# ุชุญูู ูู:
1. ุญุงูุฉ ุงููุงุชุณุงุจ: GET /api/whatsapp/persistent-connection
2. ุญุงูุฉ ุงููุญุฑู: GET /api/automation/status  
3. ุชูููู ุงูุฑุณุงุฆู: GET /api/config/messages
4. ุจูุงูุงุช ุงูุฌุฏุงูู: GET /api/sheets/data
```

### ูุดููุฉ: ุฎุทุฃ ูู template replacement
```bash
# ุงุฎุชุจุฑ:
GET /api/test/automation-engine

# ุฅุฐุง ูุดูุ ุชุญูู ูู:
- ุชูููู ุงูุฑุณุงุฆู ูู config/messages.json
- ุตุญุฉ ูุชุบูุฑุงุช ุงูุฑุณุงุฆู {name}, {orderId}, etc.
```

### ูุดููุฉ: ุงููุทุงุน ุงูุงุชุตุงู
```bash
# ุงุณุชุฎุฏู:
POST /api/whatsapp/persistent-connection
{"action": "restart-browser"}

# ุฃู:
POST /api/whatsapp/persistent-connection  
{"action": "clear-session"}
```

## ๐ฏ ุงููุชุงุฆุฌ ุงููุชููุนุฉ

ุจุนุฏ ุชุทุจูู ุงูุฅุตูุงุญุงุช:
- โ **ุนุฏู ุธููุฑ ุฃุฎุทุงุก** `Cannot read properties of undefined`
- โ **ุฅุฑุณุงู ุฑุณุงุฆู ูุงุฌุญ** ูุฌููุน ุญุงูุงุช ุงูุทูุจุงุช
- โ **ูุนุงูุฌุฉ ุฐููุฉ** ููุจูุงูุงุช ุงูููููุฏุฉ
- โ **ุงุชุตุงู ูุณุชูุฑ** ูุน ุงููุงุชุณุงุจ 24/7
- โ **ุชุณุฌูู ููุตู** ูุฌููุน ุงูุนูููุงุช

## ๐ ุงูุฏุนู ุงูููู

ุฅุฐุง ุงุณุชูุฑุช ุงููุดุงูู:
1. **ุฑุงุฌุน ุงูู logs** ูู terminal ู browser console
2. **ุงุฎุชุจุฑ endpoints** ุงููุฑุฏูุฉ ููุชุฃูุฏ ูู ุนูููุง
3. **ุชุญูู ูู ุงูุชูููู** ูู ูููุงุช config
4. **ุฃุนุฏ ุชุดุบูู ุงูุชุทุจูู** ุฅุฐุง ูุฒู ุงูุฃูุฑ

---

**ููุงุญุธุฉ**: ุงููุธุงู ุงูุขู ูุญูู ุถุฏ ุฌููุน ุฃููุงุน ุงูุฃุฎุทุงุก ุงููุชุนููุฉ ุจุงูุจูุงูุงุช ุงูููููุฏุฉ ููููุฑ ุฑุณุงุฆู fallback ุงุญุชุฑุงููุฉ ูู ุญุงูุฉ ุญุฏูุซ ุฃู ูุดุงูู. 